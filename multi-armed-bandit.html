<!doctype html>
<!--[if lt IE 7]> <html class="no-js ie6 oldie" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js ie7 oldie" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js ie8 oldie" lang="en"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]-->
  <head>
    <meta charset="utf-8">

    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

    <link href="http://fonts.googleapis.com/css?family=Inconsolata" rel="stylesheet" type="text/css">
    <link href='http://fonts.googleapis.com/css?family=PT+Serif:400,700,400italic,700italic' rel='stylesheet' type='text/css'>

    <title>An Efficient Multi-Armed Bandit for the Web | LispCast</title>
    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@ericnormand">
    <meta name="twitter:creator" content="@ericnormand">
    <meta name="twitter:description" content="">
    <meta name="twitter:title" content="An Efficient Multi-Armed Bandit for the Web">

    <meta property="og:title" content="An Efficient Multi-Armed Bandit for the Web">
    <meta property="og:description" content="">

    <meta name="description" content="">

    <meta name="author" content="Eric Normand">

    <meta name="viewport" content="width=device-width,initial-scale=1">

    <!--[if lt IE 9]>
        <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->

    <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet" type="text/css">

    <link rel="stylesheet" href="/css/styles.css" type="text/css">

    <link rel="alternate" type="application/rss+xml"
          title="LispCast" href="/feed" />

    <!-- start Mixpanel --><script type="text/javascript">(function(f,b){if(!b.__SV){var a,e,i,g;window.mixpanel=b;b._i=[];b.init=function(a,e,d){function f(b,h){var a=h.split(".");2==a.length&&(b=b[a[0]],h=a[1]);b[h]=function(){b.push([h].concat(Array.prototype.slice.call(arguments,0)))}}var c=b;"undefined"!==typeof d?c=b[d]=[]:d="mixpanel";c.people=c.people||[];c.toString=function(b){var a="mixpanel";"mixpanel"!==d&&(a+="."+d);b||(a+=" (stub)");return a};c.people.toString=function(){return c.toString(1)+".people (stub)"};i="disable track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config people.set people.set_once people.increment people.append people.track_charge people.clear_charges people.delete_user".split(" ");
      for(g=0;g<i.length;g++)f(c,i[g]);b._i.push([a,e,d])};b.__SV=1.2;a=f.createElement("script");a.type="text/javascript";a.async=!0;a.src="//cdn.mxpnl.com/libs/mixpanel-2.2.min.js";e=f.getElementsByTagName("script")[0];e.parentNode.insertBefore(a,e)}})(document,window.mixpanel||[]);
                  mixpanel.init("ffad2bd88d2cb690edbbba6cf30b2958");</script><!-- end Mixpanel -->
                  </head>

  <body>
    <header class="banner">
      <h1 class="banner-logo">
        <a href="/">
          <img class="banner-logo-img"
               src="/img/Logo@2x.png"
               alt="LispCast" />
        </a>
      </h1>

      <div class="meta-data">
        <img class="bio-img"
             src="/img/eric_bio.jpg" />
        <a class="twitter-link"
           href="http://twitter.com/ericnormand">
          <i class="fa fa-twitter"></i>
        </a>
        <a class="github-link"
           href="https://github.com/ericnormand">
          <i class="fa fa-github"></i>
        </a>
        <a class="mail-link"
           href="mailto:eric@lispcast.com">
          <i class="fa fa-envelope"></i>
        </a>
        <a class="rss-link"
           href="/feed">
          <i class="fa fa-rss-square"></i>
        </a>
        <a class="rss-link"
           href="/archive.html">
          <i class="fa fa-list"></i>
        </a>
      </div>

    </header>

    <div class="main-container">


      <article class="article">
        <h2 class="article-title-wrapper">
          <a class="article-title"
             href="/multi-armed-bandit">
            An Efficient Multi-Armed Bandit for the Web
          </a>
        </h2>

        <div class="timestamp">
          January 20, 2015
        </div>

        
<p>Summary: * *</p>
<p>Here's the problem: you've got a landing page and you want to test different variations of the page to see what converts the best. You'd love to do A/B tests, but they've got some problems. A/B tests require human intervention and human interpretation. You've got to manage the test like a scientific experiment. You've got to be disciplined and wait for a statistically significant sample. And then you've got to interpret your messy data and choose the best variation. But always there are doubts. Did I get enough traffic? Was the traffic representatitive? Etc.</p>
<p>Of course what you would like is to &quot;fire and forget&quot;. You want to add in some variations and have the system automatically discover the best one and show it to everybody. That's the ideal. There's a problem in math called the multi-armed bandit, which is an idealized version of this problem. And they've got some solutions. They even have interesting ways of measuring the performance of one algorithm over another.</p>
<p>And you might even find a Clojure library called Touchstone. It does MAB and more! And it's plug and play! It's actually a nice library and works really well. Except for one thing: it requires Redis and uses a fixed amount of space per visitor per test. Woah! If you get a lot of traffic, you use an awful lot of memory. I know for a lot of people, that's fine, just throw more memory at the problem. But I can't handle that. I actually ran out of space rather quickly and did not want to upgrade my Redis to the next pay grade.</p>
<p>Wouldn't it be nice to have a system that takes constant server memory per variation? Variations are finite (you control them). Visitors are not (Hacker News controls them). Another nice feature is that it does not add extra database overhead to each request.</p>
<p>Can it be done?</p>
<p>Yes! And I have an existence proof on my server. Here's a warning: this is overkill in most circumstances. First of all, I totally didn't need this when I wrote it, and I still don't. The current rule-of-thumb recommendation for when to begin testing is at 3000 uniques per month. That's 100 per day. I get maybe 10 per day. So I definitely don't qualify. I should have been working on getting more traffic instead of engineering a testing system. But it was fun.</p>
<p>If you're totally ok after reading that warning, here we go.</p>
<p>Here are all the requirements that I had:</p>
<ul>
<li>Able to run a reasonable number of tests. 200 seems reasonable.</li>
<li>Each test may have up to 25 variations. Most tests will have less than 10.</li>
<li>It needs to consume a small and controllable amount of space. That means constant space per test variation.</li>
<li>It would be nice to not slow down my site with database requests.</li>
</ul>


        <div class="endmark">
          <a class="endmark-link"
             href="/">
            <img class="endmark-lambda"
                 src="/img/dot.png" />
          </a>
        </div>

      </article>


      <div class="notes">

      </div>

    </div>

    <footer class="footer-banner">
    </footer>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/3.10.0/lodash.min.js"></script>

    <script>

      mixpanel.register({URL: window.location.pathname,
      Title: $("title").text()});

      mixpanel.track("Page Visit");

    </script>
    <script src="/js/mylibs/annotated-code.js" defer></script>
    <script src="/js/libs/codemirror.js" defer></script>
    <link rel="stylesheet" href="/css/feedback.css" type="text/css">
    <script src="/js/mylibs/feedback.js" defer></script>

    <!-- Drip -->
    <script type="text/javascript">
      var _dcq = _dcq || [];
      var _dcs = _dcs || {};
      _dcs.account = '3651717';

      (function() {
      var dc = document.createElement('script');
      dc.type = 'text/javascript'; dc.async = true;
      dc.src = '//tag.getdrip.com/3651717.js';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(dc, s);
      })();

      $(document).on('submitted.drip', function(ev, data){
   if(mixpanel) {
      mixpanel.register({Email: data['fields[email]']});
      mixpanel.track('Drip Subscription');
   }
});
    </script>
  </body>
</html>
